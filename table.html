<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

    <title>CRUD FROM API</title>

    <link href="table.css" rel="stylesheet">
<!-- 
    <style>
        body{
            font-family: sans-serif;
        }
        table , th, td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 10px;
        }
        tr:nth-child(even) {
            background-color: #ddd;
        }
        th{
            background-color: #5a5a5a;
            color: white;
        }
    </style> -->
    <script src="table2excel.js"></script>
  </head>
  <body>

    <div class="container">
      <div class="d-flex bd-highlight mb-3">
        <div class="me-auto p-2 bd-highlight"><h2>ตารางแสดงข้อมูลพนักงานในเเทศบาลเมืองปากพูน</div>
     
      </div>
      
      <div class="table-responsive-lg">
        <button onclick="ExportToExcel('xlsx')">Export table to excel</button>
        <table class="table table-bordered" id="tbl_exporttable_to_xls" border="1">
            <thead class="thead-dark">
            <tr>
              <th scope="row" colspan="5">คำนำหน้า</th>
              <th scope="row" colspan="5">ชื่อ</th>
              <th scope="row" colspan="5">นามสกุล</th>
              <th scope="row" colspan="5">เพศ</th>
              <th scope="row" colspan="5">อายุ</th>
              <th scope="row" colspan="10">น้ำหนัก</th>
              <th scope="row" colspan="5">ส่วนสูง</th>
              <th scope="row" colspan="5">สังกัด</th>
              <th scope="row" colspan="5">ตำแหน่ง</th>
              <th scope="row" colspan="5">กอง</th>
              <th scope="row" colspan="5">ฝ่าย</th>

              <th scope="row" colspan="5">โรคประจำตัว</th>
              <th scope="row" colspan="5">ท่านเคยเจ็บป่วยด้วยโรคจากการทำงาน</th>
              <th scope="row" colspan="5">ท่านเคยติดเชื้อโควิด-19 (COVID-19) หรือไม่</th>
              <th scope="row" colspan="5">ท่านได้รับวัคซีนมาแล้วจำนวนกี่ เข็ม</th>
              <th scope="row" colspan="5">ท่านสูบบุหรี่หรือไม่และบ่อยเพียงใด</th>
              <th scope="row" colspan="5">จำนวนมวนที่สูบต่อวัน (มวนต่อวัน)</th>
              <th scope="row" colspan="5">ท่านออกกำลังกายหรือเล่นกีฬาประเภทใด</th>
              <th scope="row" colspan="5">ระยะเวลาการออกกำลังกายหรือเล่นกีฬา (นาที/ครั้ง)</th>
              <th scope="row" colspan="5">ความถี่ของการออกกำลังกายหรือเล่นกีฬา</th>
              <th scope="row" colspan="5">แผนก-ตำแหน่งงานที่ปฏิบัติ</th>
            </tr>
          </thead>
          <tbody id="mytable">
            <tr>
              <th scope="row" colspan="10">Loading...</th>
            </tr>
          </tbody>
         
        </table>
      </div>
    </div>

    <script src="table.js"></script>
    <script>

        function ExportToExcel(type, fn, dl) {
            var elt = document.getElementById('tbl_exporttable_to_xls');
            var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
            return dl ?
                XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }) :
                XLSX.writeFile(wb, fn || ('MySheetName.' + (type || 'xlsx')));
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
  </body>
</html>